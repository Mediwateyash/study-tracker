<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BDA Study Progress Tracker — Yash</title>
<style>
  :root {
    --bg:#0f1724;--card:#0b1220;--accent:#7dd3fc;--good:#22c55e;--bad:#ef4444;--text:#e5edf6;--muted:#94a3b8;
  }
  *{box-sizing:border-box;font-family:Inter,Segoe UI,Roboto,sans-serif;}
  body{background:linear-gradient(180deg,#081122,#0b1626);color:var(--text);margin:0;padding:20px;}
  .container{max-width:950px;margin:auto;}
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
  header h1{font-size:20px;margin:0;}
  #clock{color:var(--accent);font-weight:700;}
  .card{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.05);padding:16px;border-radius:12px;margin-bottom:12px;}
  label{font-size:13px;color:var(--muted);}
  input{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:6px 8px;}
  .modules{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;}
  .mod{background:#0c1a2f;border-radius:8px;padding:10px;min-width:170px;}
  .mod h3{margin:0;font-size:14px;}
  .line{display:flex;justify-content:space-between;font-size:13px;padding:5px 0;border-bottom:1px dashed rgba(255,255,255,0.05);}
  .line:last-child{border-bottom:none;}
  .status{display:flex;align-items:center;gap:8px;}
  .ok{color:var(--good);font-weight:700;}
  .over{color:var(--bad);font-weight:700;}
  .small{font-size:13px;color:var(--muted);}
  .completed-section{margin-top:16px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.05);}
  .completed-item{display:flex;justify-content:space-between;align-items:center;padding:6px 0;font-size:12px;border-bottom:1px dashed rgba(255,255,255,0.03);}
  .completed-item:last-child{border-bottom:none;}
  .completed-time{color:var(--muted);}
  .late{color:var(--bad);}
  .early{color:var(--good);}
  .on-time{color:var(--good);}
  footer{text-align:center;padding:24px 16px;margin-top:32px;border-top:1px solid rgba(255,255,255,0.05);}
  .footer-content{display:flex;flex-direction:column;gap:8px;align-items:center;}
  .footer-links{display:flex;gap:16px;align-items:center;flex-wrap:wrap;justify-content:center;}
  .footer-link{color:var(--accent);text-decoration:none;font-size:13px;transition:opacity 0.2s;}
  .footer-link:hover{opacity:0.8;text-decoration:underline;}
  .footer-text{color:var(--muted);font-size:12px;}
  .footer-name{color:var(--accent);font-weight:600;}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>BDA (Big Data & Analytics) Study Tracker</h1>
    <div id="clock">--:--:--</div>
  </header>

  <div class="card">
    <div style="display:grid;gap:8px;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));">
      <div><label>Current Time</label><input id="currentTime" type="time" value="00:00"></div>
      <div><label>Target End (Sleep) Time</label><input id="sleepTime" type="time" value="02:00"></div>
    </div>
    <label style="margin-top:6px;display:block;"><input type="checkbox" id="ignoreSleep"> Ignore end time (manual overtime allowed)</label>
  </div>

  <div class="card">
    <label>Modules (mark done / edit minutes)</label>
    <div id="modules" class="modules"></div>
  </div>

  <div class="card">
    <div class="status"><span id="track" class="ok">On track</span><span id="summary" class="small"></span></div>
    <div id="timeline"></div>
    <div class="small" style="margin-top:8px;">
      Remaining study: <span id="studyMin"></span> | Time until 2 AM: <span id="timeLeft"></span> | Delay: <span id="overtime"></span>
    </div>
    <div class="small" id="oneLine" style="margin-top:6px;"></div>
    <div id="completedSection" class="completed-section" style="display:none;">
      <label style="display:block;margin-bottom:8px;color:var(--muted);font-size:13px;">Completed Modules:</label>
      <div id="completedList"></div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-text">
        Designed and deployed by <a href="https://github.com/Mediwateyash" target="_blank" class="footer-link footer-name">diwateyash</a>
      </div>
      <div class="footer-links">
        <a href="https://www.linkedin.com/in/diwateyash2004" target="_blank" class="footer-link">LinkedIn</a>
        <span class="footer-text">•</span>
        <span class="footer-text">notescloud by dy</span>
      </div>
    </div>
  </footer>
</div>

<script>
let topics = [
 {id:1,name:"Module 1 – Intro & Hadoop",min:15,done:false,completedAt:null},
 {id:2,name:"Module 2 – HDFS & MapReduce",min:20,done:false,completedAt:null},
 {id:3,name:"Module 3 – NoSQL",min:20,done:false,completedAt:null},
 {id:4,name:"Module 4 – Data Streams",min:20,done:false,completedAt:null},
 {id:5,name:"Module 5 – Real-Time Models",min:20,done:false,completedAt:null},
 {id:6,name:"Module 6 – R Programming",min:20,done:false,completedAt:null},
 {id:7,name:"Revision",min:5,done:false,completedAt:null}
];
const modulesDiv=document.getElementById("modules");
function pad(n){return String(n).padStart(2,"0");}
function nowHHMM(){let d=new Date();return pad(d.getHours())+":"+pad(d.getMinutes());}
function mins(t){let [h,m]=t.split(":").map(Number);return h*60+m;}
function timeStr(m){m=((m%1440)+1440)%1440;return pad(Math.floor(m/60))+":"+pad(m%60);}
function minToHours(m){
  if(m===0) return "0 hr";
  const h=Math.floor(m/60);
  const min=m%60;
  if(h===0) return `${min} min`;
  if(min===0) return `${h} hr`;
  return `${h}:${pad(min)} hr`;
}
function loadFromStorage(){
  const saved=localStorage.getItem('studyTrackerData');
  if(saved){
    try{
      const data=JSON.parse(saved);
      topics.forEach(t=>{
        const savedT=data.find(s=>s.id===t.id);
        if(savedT){
          t.done=savedT.done||false;
          t.completedAt=savedT.completedAt||null;
          if(savedT.min) t.min=savedT.min;
        }
      });
    }catch(e){}
  }
}
function saveToStorage(){
  localStorage.setItem('studyTrackerData',JSON.stringify(topics));
}
function buildUI(){
  modulesDiv.innerHTML="";
  topics.forEach(t=>{
    const d=document.createElement("div");
    d.className="mod";
    d.innerHTML=`<h3>${t.name}</h3>
    <label><input type="checkbox" data-id="${t.id}" ${t.done?"checked":""}/> Done</label><br>
    <label>Minutes <input type="number" data-min="${t.id}" value="${t.min}"></label>`;
    modulesDiv.appendChild(d);
  });
  modulesDiv.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
    cb.addEventListener('change',function(e){
      const id=+this.dataset.id;
      const topic=topics.find(t=>t.id===id);
      if(topic){
        if(this.checked && !topic.done){
          topic.completedAt=nowHHMM();
          topic.done=true;
        }else if(!this.checked){
          topic.completedAt=null;
          topic.done=false;
        }
        saveToStorage();
        recalc();
      }
    });
  });
}
function recalc(){
  const nowT=document.getElementById("currentTime").value||nowHHMM();
  const sleepT=document.getElementById("sleepTime").value;
  const ignore=document.getElementById("ignoreSleep").checked;
  const allModules=[...modulesDiv.querySelectorAll(".mod")].map(el=>({
     id:+el.querySelector("input[type=checkbox]").dataset.id,
     name:el.querySelector("h3").innerText,
     done:el.querySelector("input[type=checkbox]").checked,
     min:+el.querySelector("input[type=number]").value||1
  }));
  const rem=allModules.filter(x=>!x.done);
  const completed=allModules.filter(x=>x.done);
  const nowM=mins(nowT),sleepM=mins(sleepT);
  const startTimeM=mins("00:00");
  let tillSleep;
  let pastDeadline = false;
  if(nowM <= sleepM) {
    tillSleep = sleepM - nowM;
  } else {
    pastDeadline = true;
    tillSleep = 0;
  }
  let total=rem.reduce((s,a)=>s+a.min,0);
  const totalScheduled=topics.reduce((s,a)=>s+a.min,0);
  const scheduledEnd=startTimeM+totalScheduled;
  let overtime = 0;
  if (!ignore) {
    if (pastDeadline) {
      overtime = total + (nowM - sleepM);
    } else if(nowM > scheduledEnd) {
      overtime = (nowM - scheduledEnd) + total;
    } else {
      let diff = total - tillSleep;
      if (diff > 0) overtime = diff;
      else overtime = 0;
    }
  } else {
    overtime = 0;
  }
  const timeline=document.getElementById("timeline");
  timeline.innerHTML="";
  let ptr=startTimeM;
  let isLate=false;
  let currentModuleEnd=null;
  let accumulatedDelay=0;
  rem.forEach(t=>{
    let st=ptr,en=ptr+t.min;
    const isPast=nowM>en;
    if(isPast && !t.done) {
      isLate=true;
      currentModuleEnd=en;
      accumulatedDelay=nowM-en;
    }
    ptr=en;
    const div=document.createElement("div");
    div.className="line";
    const lateClass=isPast && !t.done?"over":"";
    div.innerHTML=`<span class="${lateClass}">${t.name}</span><span class="${lateClass}">${timeStr(st)} → ${timeStr(en)}${isPast && !t.done?" (LATE)":""}</span>`;
    timeline.appendChild(div);
  });
  const baseFinishTime = startTimeM + total;
  const adjustedFinishTime = baseFinishTime + accumulatedDelay;
  const finishTime = timeStr(adjustedFinishTime);
  if(pastDeadline && !ignore) {
    document.getElementById("track").className="over";
    document.getElementById("track").innerText="Past deadline";
    const timePast = nowM - sleepM;
    document.getElementById("summary").innerText=`Past deadline by ${minToHours(timePast)} | Expected finish: ${finishTime} (Total delay: ${minToHours(overtime)})`;
  } else if(isLate && !ignore) {
    const lateBy = accumulatedDelay;
    document.getElementById("track").className="over";
    document.getElementById("track").innerText="Late";
    document.getElementById("summary").innerText=`${minToHours(lateBy)} behind | Expected finish: ${finishTime}`;
  } else {
    document.getElementById("track").className=overtime?"over":"ok";
    document.getElementById("track").innerText=overtime?"Behind":"On track";
    document.getElementById("summary").innerText=overtime?`Expected finish: ${finishTime} (Delayed by ${minToHours(overtime)})`:`Expected finish: ${finishTime}`;
  }
  document.getElementById("studyMin").innerText=minToHours(total);
  document.getElementById("timeLeft").innerText=pastDeadline?"Past deadline":minToHours(tillSleep);
  document.getElementById("overtime").innerText=minToHours(overtime);
  let orderStr=rem.map(t=>"M"+t.id).join("→")||"All done";
  let statusText;
  if(pastDeadline && !ignore) {
    statusText = `Past deadline by ${minToHours(nowM - sleepM)}`;
  } else if(isLate && !ignore) {
    statusText = `${minToHours(accumulatedDelay)} behind`;
  } else {
    statusText = overtime ? `Delay ${minToHours(overtime)}` : "On time";
  }
  document.getElementById("oneLine").innerText=`${nowT} | ${orderStr} | ${minToHours(total)} left | ${statusText} | Finish ≈ ${finishTime}`;
  
  showCompleted(completed,startTimeM);
}
function showCompleted(completed,startTime){
  const section=document.getElementById("completedSection");
  const list=document.getElementById("completedList");
  if(completed.length===0){
    section.style.display="none";
    return;
  }
  section.style.display="block";
  list.innerHTML="";
  const startTimeM=mins("00:00");
  let ptr=startTimeM;
  const completedMap=new Map(completed.map(c=>[c.id,c]));
  const allModules=[...modulesDiv.querySelectorAll(".mod")].map(el=>({
     id:+el.querySelector("input[type=checkbox]").dataset.id,
     name:el.querySelector("h3").innerText,
     min:+el.querySelector("input[type=number]").value||1
  }));
  const moduleMap=new Map(allModules.map(m=>[m.id,m]));
  topics.forEach(topic=>{
    if(!completedMap.has(topic.id)) {
      const mod=moduleMap.get(topic.id);
      if(mod) ptr+=mod.min;
      return;
    }
    const c=completedMap.get(topic.id);
    const mod=moduleMap.get(topic.id);
    const expectedEnd=ptr+(mod?mod.min:topic.min);
    ptr=expectedEnd;
    const completedAt=topic.completedAt?mins(topic.completedAt):null;
    if(!completedAt) return;
    const delay=completedAt-expectedEnd;
    const delayStr=delay>0?`${minToHours(delay)} late`:delay<0?`${minToHours(Math.abs(delay))} early`:"On time";
    const delayClass=delay>0?"late":delay<0?"early":"on-time";
    const div=document.createElement("div");
    div.className="completed-item";
    div.innerHTML=`<span>${c.name}</span><span class="completed-time"><span class="${delayClass}">Completed at ${timeStr(completedAt)} (${delayStr})</span> | Expected: ${timeStr(expectedEnd)}</span>`;
    list.appendChild(div);
  });
}
function clock(){
  let d=new Date();
  document.getElementById("clock").innerText=d.toLocaleTimeString();
}
function initSchedule(){
  const currentTimeInput=document.getElementById("currentTime");
  const sleepTimeInput=document.getElementById("sleepTime");
  if(!currentTimeInput.value) currentTimeInput.value="00:00";
  if(!sleepTimeInput.value) sleepTimeInput.value="02:00";
}
loadFromStorage();
buildUI();
initSchedule();
setInterval(clock,1000);
setInterval(recalc,1500);
modulesDiv.addEventListener("change",function(e){
  if(e.target.type==="number"){
    const id=+e.target.dataset.min;
    const topic=topics.find(t=>t.id===id);
    if(topic) topic.min=+e.target.value||1;
    saveToStorage();
  }
  recalc();
});
document.querySelectorAll("#currentTime, #sleepTime, #ignoreSleep").forEach(i=>i.addEventListener("change",recalc));
recalc();
</script>
</body>
</html>
